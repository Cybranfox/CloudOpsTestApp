{% extends "base.html" %}

{% block title %}AWS Cloud Orbit - Your Adventure Awaits{% endblock %}

{% block content %}
<div class="mascot-container">
    <img src="{{ url_for('static', filename='zap.png') }}" alt="Zap" class="zap" id="zapMascot">
    <div class="speech-bubble" id="zapSpeech">
        Welcome to your AWS journey!
    </div>
</div>

<div class="card progress-section">
    <h2>Adventure Progress</h2>
    
    <div class="stats-grid">
        <div class="stat-item">
            <span class="stat-icon">üåü</span>
            <span class="stat-label">XP:</span>
            <span class="stat-value">{{ progress.xp }}</span>
        </div>
        
        <div class="stat-item">
            <span class="stat-icon">üî•</span>
            <span class="stat-label">Streak:</span>
            <span class="stat-value">{{ progress.streak }} days</span>
        </div>
    </div>
    
    <div class="energy-display">
        <strong>‚ö° Energy Shields:</strong>
        <div class="shields">
            {% for i in range(progress.max_energy) %}
                {% if i < progress.energy %}
                    <span class="shield-full">‚ö°</span>
                {% else %}
                    <span class="shield-empty">‚ö°</span>
                {% endif %}
            {% endfor %}
        </div>
    </div>
</div>

<div class="card achievements-section">
    <h3>üèÜ Badges Earned</h3>
    <div class="badges-container">
        {% for badge in progress.badges %}
            <span class="badge-item">{{ badge }}</span>
        {% endfor %}
        {% if not progress.badges %}
            <p class="no-badges"><em>Complete lessons to earn badges!</em></p>
        {% endif %}
    </div>
</div>

<div class="card inventory-section">
    <h3>üéí Relics Collected</h3>
    <div class="relics-container">
        {% for relic in progress.inventory.relics %}
            <div class="relic-item">
                <strong>{{ relic.name }}</strong>: {{ relic.description }}
            </div>
        {% endfor %}
        {% if not progress.inventory.relics %}
            <p class="no-relics"><em>Discover powerful relics in elite battles!</em></p>
        {% endif %}
    </div>
</div>

<div class="card adventure-map">
    <h2>üó∫Ô∏è Adventure Map</h2>
    <p>Choose your next challenge:</p>
    
    <div class="lesson-grid">
        {% for i in range(1, 21) %}
            {% set available = i <= progress.current_lesson %}
            {% set completed = i in progress.completed_lessons %}
            
            {% if completed %}
                <a href="{{ url_for('lesson_page', lesson_id=i) }}" class="lesson-node completed">
                    <div class="node-icon">‚úÖ</div>
                    <div class="node-title">Lesson {{ i }}</div>
                    <div class="node-status">Completed</div>
                </a>
            {% elif available %}
                <a href="{{ url_for('lesson_page', lesson_id=i) }}" class="lesson-node available">
                    <div class="node-icon">‚öîÔ∏è</div>
                    <div class="node-title">Lesson {{ i }}</div>
                    <div class="node-status">Available</div>
                </a>
            {% else %}
                <div class="lesson-node locked">
                    <div class="node-icon">üîí</div>
                    <div class="node-title">Lesson {{ i }}</div>
                    <div class="node-status">Locked</div>
                </div>
            {% endif %}
        {% endfor %}
    </div>
</div>

<style>
.progress-section {
    background: linear-gradient(135deg, rgba(var(--color-success-rgb), 0.1), rgba(var(--color-teal-800-rgb, 41, 150, 161), 0.1));
    border-color: var(--color-success);
}

.stats-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: var(--space-20);
    margin: var(--space-20) 0;
}

.stat-item {
    display: flex;
    align-items: center;
    gap: var(--space-12);
    padding: var(--space-16);
    background: rgba(var(--color-primary-rgb, 33, 128, 141), 0.1);
    border-radius: var(--radius-base);
    border: 1px solid rgba(var(--color-primary-rgb, 33, 128, 141), 0.3);
}

.stat-icon {
    font-size: var(--font-size-3xl);
}

.stat-label {
    font-weight: var(--font-weight-medium);
    color: var(--color-text);
}

.stat-value {
    font-weight: var(--font-weight-bold);
    color: var(--color-primary);
    font-size: var(--font-size-xl);
}

.energy-display {
    text-align: center;
    margin: var(--space-24) 0;
    padding: var(--space-20);
    background: rgba(var(--color-info-rgb, 98, 108, 113), 0.1);
    border-radius: var(--radius-base);
    border: 2px solid rgba(var(--color-info-rgb, 98, 108, 113), 0.3);
}

.shields {
    display: flex;
    justify-content: center;
    gap: var(--space-12);
    margin: var(--space-16) 0;
}

.shield-full {
    color: #f7d51d;
    font-weight: bold;
    font-size: 2em;
    text-shadow: 0 0 8px rgba(247, 213, 29, 0.6);
    filter: drop-shadow(0 0 4px rgba(247, 213, 29, 0.8));
    animation: pulse 2s infinite;
}

.shield-empty {
    color: #444;
    opacity: 0.3;
    font-size: 2em;
    filter: grayscale(100%);
}

@keyframes pulse {
    0%, 100% { transform: scale(1); }
    50% { transform: scale(1.1); }
}

.achievements-section {
    background: linear-gradient(135deg, rgba(var(--color-warning-rgb, 168, 75, 47), 0.1), rgba(var(--color-orange-400-rgb, 230, 129, 97), 0.1));
    border-color: var(--color-warning);
}

.badges-container {
    display: flex;
    flex-wrap: wrap;
    gap: var(--space-12);
    margin-top: var(--space-16);
}

.badge-item {
    background: linear-gradient(135deg, var(--color-warning), var(--color-orange-400));
    color: var(--color-slate-900);
    padding: var(--space-8) var(--space-16);
    border-radius: var(--radius-full);
    font-weight: var(--font-weight-bold);
    font-size: var(--font-size-sm);
    box-shadow: var(--shadow-sm);
    border: 2px solid rgba(var(--color-warning-rgb, 168, 75, 47), 0.5);
}

.inventory-section {
    background: linear-gradient(135deg, rgba(var(--color-orange-500-rgb, 168, 75, 47), 0.1), rgba(var(--color-orange-400-rgb, 230, 129, 97), 0.1));
    border-color: var(--color-orange-400);
}

.relics-container {
    margin-top: var(--space-16);
}

.relic-item {
    margin: var(--space-12) 0;
    padding: var(--space-16);
    background: rgba(var(--color-orange-500-rgb, 168, 75, 47), 0.1);
    border-radius: var(--radius-base);
    border-left: 4px solid var(--color-warning);
    color: var(--color-text);
    transition: all var(--duration-normal) var(--ease-standard);
}

.relic-item:hover {
    transform: translateX(4px);
    background: rgba(var(--color-orange-500-rgb, 168, 75, 47), 0.15);
}

.adventure-map {
    background: linear-gradient(135deg, rgba(var(--color-primary-rgb, 33, 128, 141), 0.1), rgba(var(--color-teal-600-rgb, 29, 116, 128), 0.1));
    border-color: var(--color-primary);
}

.lesson-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
    gap: var(--space-16);
    margin: var(--space-24) 0;
}

.lesson-node {
    display: block;
    padding: var(--space-20);
    text-align: center;
    border-radius: var(--radius-lg);
    text-decoration: none;
    transition: all var(--duration-normal) var(--ease-standard);
    border: 2px solid transparent;
    color: var(--color-text);
    font-weight: var(--font-weight-medium);
    position: relative;
    overflow: hidden;
}

.lesson-node::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
    transition: left 0.5s;
}

.lesson-node:hover::before {
    left: 100%;
}

.lesson-node.available {
    background: linear-gradient(135deg, var(--color-success), var(--color-teal-600));
    border-color: var(--color-success);
    box-shadow: 0 6px 12px rgba(var(--color-success-rgb, 33, 128, 141), 0.3);
    color: var(--color-btn-primary-text);
}

.lesson-node.completed {
    background: linear-gradient(135deg, var(--color-warning), var(--color-orange-400));
    color: var(--color-slate-900);
    border-color: var(--color-warning);
    box-shadow: 0 6px 12px rgba(var(--color-warning-rgb, 168, 75, 47), 0.3);
}

.lesson-node.locked {
    background: var(--color-secondary);
    color: var(--color-text-secondary);
    cursor: not-allowed;
    opacity: 0.6;
    border-color: var(--color-border);
}

.lesson-node:hover:not(.locked) {
    transform: translateY(-4px) scale(1.02);
    box-shadow: var(--shadow-lg);
}

.node-icon {
    font-size: var(--font-size-4xl);
    margin-bottom: var(--space-12);
    display: block;
}

.node-title {
    font-weight: var(--font-weight-bold);
    font-size: var(--font-size-base);
    margin-bottom: var(--space-4);
}

.node-status {
    font-size: var(--font-size-xs);
    opacity: 0.9;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.no-badges, .no-relics {
    color: var(--color-text-secondary);
    font-style: italic;
    text-align: center;
    padding: var(--space-24);
    background: rgba(var(--color-text-rgb, 19, 52, 59), 0.05);
    border-radius: var(--radius-base);
    border: 1px dashed var(--color-border);
}

@media (max-width: 768px) {
    .lesson-grid {
        grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
        gap: var(--space-12);
    }
    
    .stats-grid {
        grid-template-columns: 1fr;
        gap: var(--space-12);
    }
    
    .badges-container {
        justify-content: center;
    }
    
    .shields {
        gap: var(--space-8);
    }
    
    .shield-full, .shield-empty {
        font-size: 1.5em;
    }
}

@media (max-width: 480px) {
    .lesson-grid {
        grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
    }
    
    .lesson-node {
        padding: var(--space-16);
    }
    
    .node-icon {
        font-size: var(--font-size-3xl);
    }
}
</style>

{% endblock %}